(e=>{"use strict";e.ammo=function(){const t=t=>t||e.document,n=(e,n)=>t(n).querySelector(e),r=(e,n)=>t(n).querySelectorAll(e),o=(e,t)=>{Object.keys(e).forEach((n,r)=>t(e[n],r))},s=e=>"object"==typeof e&&!c(e)&&!i(e),i=e=>null===e,a=e=>"number"==typeof e&&!isNaN(e),u=e=>"function"==typeof e,c=e=>Array.isArray(e),l=e=>"string"==typeof e,d=e=>void 0===e,f=e=>"boolean"==typeof e,p=(e,t)=>e.hasOwnProperty(t),h=e=>Object.keys(e),g=(e,t)=>{Object.keys(e).forEach((n,r)=>t(e[n],n,r))},m=(e,t,n)=>{e(n=n||0,r=>{if(!r)return t();m(e,t,++n)})},y=(e,t,n)=>{setTimeout(()=>{e(r=>{if(r)return y(e,t,n);t()})},n)},v=function(){const e=[];let t,n;const r=function(o=0){let s;if(!e||o>=e.length)return!0;(s=e[o])({resolve:function(e){t=e,n=null,r(++o)},reject:function(e){n=e,t=null,r(++o)},response:{value:t,error:n}})};return{chain:function(t){return e&&e.push(t),this},execute:r}},x=e=>{const t={};return g(e,(e,n)=>t[n]=e.value),new Proxy(t,{get:(e,t)=>e[t],set(t,n,r){const o=e[n].type;if(!(e=>{switch(e){case"number":return a;case"object":return s;case"null":return i;case"function":return u;case"array":return c;case"string":return l;case"undefined":return d;case"bool":return f;default:return d}})(o)(r))throw new Error(`[Ammo.StrongType] Invalid type. Expected type for field {${n}} is {${o}}`);return t[n]=r,!0}})},b=(e,t,n,r)=>{e.style.setProperty(t,u(n)?n(e,r)||e.style.getProperty(t):n,"")},S=(e,t,n,r)=>{const o=e.getAttribute(t);e.setAttribute(t,u(n)?n(e,o,r)||o:n)},w=(e,t,n)=>{e.innerHTML=u(t)?t(e.innerHTML,n)||e.innerHTML:t},E=function(e,t){let n,i=l(e)?r(e,t):e;return{filter(t){return n=[],o(i,(r,s)=>{((e,t,n,r)=>{if(u(t))return t(e,r);if(l(t)){if(-1===t.indexOf(":"))return e.classList.contains(t);const r=e.parentNode.querySelectorAll(`${n}${t}`);let s=!1;return o(r,t=>{t.isSameNode(e)&&!s&&(s=!0)}),s}})(r,t,e,s)&&n.push(r)}),i=n,this},find(e){return n?n=r(e,n.firstChild):i=r(e,i.firstChild),this},text(e){return o(n||i,(t,n)=>w(t,e,n)),this},style(e,t){return o(n||i,(n,r)=>b(n,e,t,r)),this},attr(e,t){return o(n||i,(n,r)=>S(n,e,t,r)),this},data(e){return o(n||i,(t,n)=>t.innerHTML=e[n]),this},on(e,t){return o(n||i,n=>n.addEventListener(e,t)),this},each(e){return o(n||i,e),this},eq(e){const t=n||i;return t.length>0&&s(t[e])?t[e]:void 0},index(e){let t=-1;return o(n||i,(n,r)=>{n.classList.contains(e)&&-1===t&&(t=r)}),t},async(e,t){const r=v();return o(n||i,(t,n)=>{r.chain(r=>e(r.resolve,t,n))}),u(t)&&r.chain(()=>t()),r.execute(),this},get:()=>n||i}};return{onDomReady:t=>{e.document.addEventListener("DOMContentLoaded",t)},onHover:(e,t,n)=>{let r;o(e,e=>{e.addEventListener("mouseenter",e=>{r=e.target,t(e)}),e.addEventListener("mouseout",e=>{n(e,r)})})},delegateEvent:(e,n,r,o)=>{let s=n.indexOf(".")>-1?n.split("."):[n];s=s.filter(e=>!d(e)&&""!==e);let i=0;t(o).addEventListener(e,e=>{e.target&&s.map(t=>(e.target.classList.contains(t)&&i++,t)),i===s.length&&i>0&&r(e),i=0})},jsonCopy:e=>JSON.parse(JSON.stringify(e)),getEl:n,getEls:r,isHovered:e=>{const t=n(e);return t.parentNode.querySelector(":hover")===t},appendAfter:(e,n)=>(t(n).insertAdjacentHTML("afterend",e.toString()),this),appendBefore:(e,n)=>(t(n).insertAdjacentHTML("beforeend",e.toString()),this),prependAfter:(e,n)=>(t(n).insertAdjacentHTML("afterbegin",e.toString()),this),prependBefore:(e,n)=>(t(n).insertAdjacentHTML("beforebegin",e.toString()),this),removeEl:e=>(e.parentNode.removeChild(e),this),each:o,isObj:s,isNull:i,isNum:a,isFunc:u,isArr:c,isStr:l,isUndef:d,isBool:f,hasProp:p,hasMethod:(e,t)=>p(e,t)&&u(e[t]),hasKey:(e,t)=>h(e).indexOf(t)>-1,getKeys:h,eachKey:g,getUrlParam:e=>{const t=new RegExp(`[?&]${e}=([^&]*)`).exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))},randomInclusive:(e,t)=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e),recurIter:m,poll:y,buffer:function(){let e={};return(t,n,r)=>{t||(e[t]="0"),e[t]&&clearTimeout(e[t]),e[t]=setTimeout(r,n)}},extend:function(){let e=arguments[0],t=Object.assign(e,{}),n=[];return g(arguments,(e,t,r)=>{r>0&&n.push(e)}),n.forEach(e=>{Object.assign(t,e)}),t},runMethods:(e,t)=>{const n=c(t)?t:[];g(e,(e,t)=>{if(!u(e)||n.indexOf(t)>-1)return!1;e()})},parseToType:e=>{if(l(e))return"true"===e||"false"!==e&&("null"===e?null:+e+""===e?+e:e)},template:(e,t)=>{let n;const r={start:"{{",end:"}}"},o={id:"data-ammo-key",idValue:"data-ammo-key-value",observer:"data-ammo-observer"},s="_ao_",i=/(key:[a-zA-Z]+)/g,a=(e=>{let t=e.match(i)[0],n=t.indexOf(":");return t.substring(n+1,t.length)})(e);let c=((e,t,n)=>{let r=[],o=e.indexOf(n.start),s=e.indexOf(n.end);if(o>-1&&s>-1)for(;o>-1&&s>-1;){let i=t();if(i.name=e.substring(o,s).replace(n.start,"").replace(n.end,""),r.push(i),o-2>=0&&"="===e[o-2]){i.isAttr=!0;let t=o-3,n=0,r=!1,s="";for(;!r&&t>=0;){if(" "===e[t]){r=!0,i.index=e.indexOf(">",t);break}s+=e[t],t--,n++}i.attr=s.split("").reverse().join("")}else i.index=e.indexOf(">",o-n.start.length);o=e.indexOf(n.start,o+1),s=e.indexOf(n.end,s+1)}return r})(e,()=>({index:0,name:"",value:"",isAttr:!1,attr:""}),r);e=(e=>{let t=e,n=0;return c.forEach(e=>{e.isAttr||(t=n>0?[t.slice(0,e.index+s.length-1),s,t.slice(e.index+s.length)].join(""):[t.slice(0,e.index),s,t.slice(e.index+1)].join(""),n++)}),t})(e);return n=((e,t,n,a)=>{let u="";return t.forEach(t=>{let c=e;c=((e,t,n)=>{let r=e.match(i)[0],s=e.indexOf(r);return`${e.substring(0,s-1)}${o.id}="${t}" ${o.idValue}="${n.toLowerCase()}"${e.substring(s+r.length+1,e.length)}`})(c,a,t[a]),n.length>0&&n.forEach(e=>{e.value=t[e.name];let n=c.indexOf(">",e.index);const o=` data-ammo-observer="${e.name}"`;e.isAttr?(c=[c.slice(0,n),o,c.slice(n)].join(""),c=c.replace(new RegExp(r.start+e.name+r.end,"g"),t[e.name])):(c=c.replace(new RegExp(s),`${o}>`),c=c.replace(new RegExp(r.start+e.name+r.end,"g"),t[e.name]))}),u+=c}),u.replace(/{/g,"").replace(/}/g,"")})(e,t,c,a),{render(e,t){e.innerHTML=n,u(t)&&t()},updateVal(e,t,n){E(`[${o.id}="${a}"][${o.idValue}="${e.toLowerCase()}"]`).each(e=>{E(`[${o.observer}="${t}"]`,e).each(e=>e.innerHTML=n)})},updateAttr(e,t,n){const r=c.filter(e=>e.name===t)[0];E(`[${o.id}="${a}"][${o.idValue}="${e.toLowerCase()}"]`).each(e=>{E(`[${o.observer}="${t}"]`,e).each(e=>e.setAttribute(r.attr,n))})},getId:e=>e.getAttribute(o.id),getIdValue:e=>e.getAttribute(o.idValue)}},request:e=>{let t=new XMLHttpRequest;if(t.onreadystatechange=(()=>{t.readyState===XMLHttpRequest.DONE&&(200===t.status?e.callback(null,JSON.parse(t.responseText)):e.callback(t.responseText,null))}),t.open(e.type||"GET",e.url),e.data){t.setRequestHeader("Content-Type","application/x-www-form-urlencoded");let n=[];h(e.data).forEach(t=>{n.push(`${t}=${e.data[t]}`)}),t.send(n.join("&"))}else t.send()},store:function(e){let t;if(!l(e))return new Error("[Storage] Invalid storage key. Provide a key {string}.");t={getStorage:function(){return localStorage},setStorageItem:function(e,t){this.getStorage().setItem(e,t)},getStorageItem:function(e){return this.getStorage().getItem(e)},removeStorageItem:function(e){this.getStorage().removeItem(e)}};const n=function(e){return function(e){return JSON.parse(e)}(t.getStorageItem(e))},r=function(e,n){t.setStorageItem(e,function(e){return JSON.stringify(e)}(n))};return{getData:function(){return null!==n(e)?n(e):void 0},setData:function(t){return r(e,t),this},removeData:function(){return function(e){t.removeStorageItem(e)}(e),this},getItem:function(e){return this.getData()[e]},setItem:function(t,n){const o=this.getData();return o[t]=n,r(e,o),this},removeItem:function(t){const n=this.getData();return n[t]=void 0,r(e,n),this}}},sequence:v,app:function(t,n){const r=s(n),o=s(t),i=o&&f(t.global)&&t.global,a=o&&f(t.strongTypes)&&t.strongTypes;if(i&&!o||i&&o&&d(t.name))throw new Error("[Ammo.app] Invalid initialization. Global applications require a name. Pass a name as part of the app's props.");let m,y={props:o?t:{},store:r?a?x(n):n:{},nodes:{}},v={default:["events","renderers","actions"],app:["events","actions","common","modules","core"],module:["events","actions","templates","views"],widget:["events","actions","widgets"]};const b=function(){const t=function(e){let t=y.nodes;return(c(e)?e:[e]).map(e=>{p(t,e)||(t[e]={})}),this},n=function(e,t,n){let r=y.nodes;return p(r,e)&&!p(r[e],t)&&u(n)&&(r[e][t]=n),this},r=function(e,t){let n=y.nodes;return!!(p(n,e)&&p(n[e],t)&&u(n[e][t]))&&n[e][t]},o=function(e){return!!p(y.nodes,e)&&{node:function(t,r){return n(e,t,r),this},configure:o}},s=function(e,t){const n=y.store;if(!p(n,e))return!1;if(!u(t))throw new Error("[Ammo.app] Invalid update handler. Make sure to pass as a second argument a pure function.");const r=t(n[e]);n[e]=r,m&&m.getData()&&m.setItem(e,r)};return{schema:function(e){return p(v,e)&&t(v[e]),this},addSchema:function(e,t){return!p(v,e)&&c(t)&&(v[e]=t),this},augment:t,configure:o,addNode:n,getNode:r,callNode:function(e,t,n){const o=d(n)?{}:n;let s=r(e,t);return s&&s(o),this},nodeExists:function(e,t){return p(y.nodes,e)&&u(y.nodes[e][t])},getNodes:function(e){return e&&p(y.nodes,e)?y.nodes[e]:y.nodes},getProps:function(e){const t=y.props;return p(t,e)?t[e]:t},inherit:function(e,r){const o=e.getNodes();return g(o,(e,o)=>{if(r&&-1===r.indexOf(o))return!1;t(o),g(e,(e,t)=>n(o,t,e))}),this},overwrite:function(e){const t=y.nodes;return!!p(t,e)&&{node:function(n,r){return t[e][n]=r,this},overwrite:this.overwrite}},getStore:function(e){const t=y.store;return p(t,e)?t[e]:t},updateStore:s,syncWithPersistentStore:function(){if(d(y.props.storeKey))throw new Error("[Ammo.app] Invalid synchronization with persistent storage. Synchronized apps require a store key. Pass a store key as part of the app's props.");return(m=e.ammo.store(y.props.storeKey)).getData()?h(m.getData()).length>0&&g(m.getData(),(e,t)=>s(t,()=>e)):m.setData(y.store),this},clearPersistentStore:function(){if(!m)return!1;m.removeData()},getPersistentStore:function(e){if(!m)return!1;const t=m.getData();return l(e)&&t?m.getItem(e):t}}};return i?((t=>e[y.props.name]=e[y.props.name]||t)(b()),e[y.props.name]):b()},select:function(e,t){let r=l(e)?n(e,t):e;return{find(e){return r=n(e,r),this},text(e){return w(r,e,0),this},style(e,t){return b(r,e,t,0),this},attr(e,t){return S(r,e,t,0),this},data(e){return r.innerHTML=e,this},on(e,t){return r.addEventListener(e,t),this},get:()=>r}},selectAll:E,setStrongTypedObject:x}}()})(window);